<!DOCTYPE html>
<html>
    <head>
        <style>
            body
            {
                background-color: black;
            }
            canvas
            {
                background-color: white;
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                width: 100%;
                height: 100%;
                image-rendering: pixelated;
            }
            debug
            {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                color: white;
                user-select: none;
                background-color: black;
                opacity: 0.35;
            }
            p
            {
                margin: 1px;
            }
        </style>
    </head>
    <body>
        <div id="Game">

        </div>
        <debug id="debugtag">
            <p>FPS: <span id="dfps"></span></p>
            <p>PRESSED: <span id="pressed"></span></p>
            <p>MOUSE PRESSED: <span id="cpressed"></span></p>
            <p>PLAYER X SPD: <span id="pxsp"></span></p>
            <p>PLAYER Y SPD: <span id="pysp"></span></p>
            <p>FACING: <span id="facing"></span></p>
            <p>ISHIT: <span id="ishit"></span></p>
            <p>ISGROUND: <span id="isground"></span></p>
            <p>ISJUMPING: <span id="isjumping"></span></p>
            <p>CAMERA X SPD: <span id="cxsp"></span></p>
            <p>CAMERA Y SPD: <span id="cysp"></span></p>
            <p>PLAYER X POS: <span id="px"></span></p>
            <p>PLAYER Y POS: <span id="py"></span></p>
            <p>PLAYER ROTATION: <span id="protation"></span></p>
            <p>CURSOR X: <span id="cursorx"></span></p>
            <p>CURSOR Y: <span id="cursory"></span></p>
        </debug>

    </body>
    <script>
        document.addEventListener("DOMContentLoaded",function()
        {
            const util = require("./src/utils")
            const render = require("./src/render")
            const mainWorker = require("./src/workers/main").main
            const escreen = require("./src/screen")
            const game = require("./src/game")
            const fs = require("fs")
            const electron = require("electron").remote
            util.print("info","Starting game...")
            util.print("info","Creating Canvas...")
            const canvas = document.createElement("canvas")
            util.print("info","Creating Render Context...")
            const ctx = canvas.getContext("2d")
            const webgl = canvas.getContext("webgl2")
            util.print("info","Creating Render...")
            const Render = new render.render(window,canvas,ctx,webgl)
            util.print("info","Creating Window...")
            Render.Init()
            game.renderUpdate(Render)
            util.print("info","Start Input")
            Render.input.Init(Render.input)
            if(fs.existsSync("./src/game/init.js"))
            {
                util.print("info","Executing Game Init Script...")
                require("./src/game/init")()
            }
            else
            {
                util.print("warn","Init Script not found!")
                electron.dialog.showMessageBoxSync(null,{title:"No Init Script!",message:"There's no Init Script in the Game folder!",detail:"Contact the Developer!",type:"warning",buttons:["Ok"]})
                escreen.SwitchToEScreen("dummy",0)
            }
            mainWorker(Render)
        })
    </script>
</html>